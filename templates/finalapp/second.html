{% extends 'finalapp/base.html' %}
{% block content %}

<div class="chart-container">
    <div class="chart-box">
        <canvas id="hospitalChart"></canvas>
    </div>
    <div class="chart-box">
        <canvas id="countsChart"></canvas>
    </div>
    <div class="chart-box">
        <canvas id="diseaseChart"></canvas>
    </div>
</div>
<script>
        // Hospital Chart
            var ctxHospital = document.getElementById('hospitalChart').getContext('2d');
            var hospitalChart = new Chart(ctxHospital, {
                type: 'line',
                data: {
                    labels: {{ hospital_types|safe }},
                    datasets: [
                        {
                            label: 'Hospitals',
                            data: {{ hospital_hospitals|safe }},
                            borderColor: 'rgba(54, 162, 235, 1)',
                            backgroundColor: 'rgba(54, 162, 235, 0.2)',
                            fill: true,
                            borderWidth: 2,
                            tension: 0.1
                        },
                        {
                            label: 'Doctors',
                            data: {{ hospital_doctors|safe }},
                            borderColor: 'rgba(255, 206, 86, 1)',
                            backgroundColor: 'rgba(255, 206, 86, 0.2)',
                            fill: true,
                            borderWidth: 2,
                            tension: 0.1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    scales: {
                        x: {
                            display: true,
                            title: {
                                display: true,

                            }
                        },
                        y: {
                            display: true,
                            title: {
                                display: true,

                            },
                            beginAtZero: true,
                        }
                    },
                    plugins: {
                            title: {
                            display: true,
                            text: '진료과목별 의료기관과 전문의수 비교현황',
                            padding: {
                                top: 10,
                                bottom: 10
                            }
                        }
                    }
                }
            });

        // Hospital counts Chart
        var ctxCounts = document.getElementById('countsChart').getContext('2d');
            var countsChart = new Chart(ctxCounts, {
                type: 'bar',
                data: {
                    labels: {{counts_regions|safe}},
                    datasets: [
                        {
                            label: '병의원',
                            data: {{counts_clinics|safe}},
                            backgroundColor: 'rgba(0, 123, 255, 0.5)',
                            borderColor: 'rgba(0, 123, 255, 1)',
                            borderWidth: 1
                        },
                        {
                            label: '보건소',
                            data: {{counts_healthcenters|safe}},
                            backgroundColor: 'rgba(255, 99, 132, 0.5)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 1
                        },
                        {
                            label: '약국',
                            data: {{ counts_pharmacys|safe }},
                            backgroundColor: 'rgba(75, 192, 192, 0.5)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 1
                        },
                        {
                            label: '치과',
                            data: {{ counts_dentists|safe }},
                            backgroundColor: 'rgba(255, 206, 86, 0.5)',
                            borderColor: 'rgba(255, 206, 86, 1)',
                            borderWidth: 1
                        },
                        {
                            label: '한의원',
                            data:{{ counts_orientals|safe }},
                            backgroundColor: 'rgba(153, 102, 255, 0.5)',
                            borderColor: 'rgba(153, 102, 255, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    scales: {
                        x: {
                            stacked: true,
                        },
                        y: {
                            stacked: true,
                            beginAtZero: true
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: '읍면동별 의료기관 현황',
                            padding: {
                                top: 10,
                                bottom: 10
                            }
                        }
                    }
                }
            });
</script>

{% if d or c %}
    <div class="tables-container">
        {% if d %}
        <div class="chart_container">
            <h4 class="text-center"><u>다빈도상병(외래)</u></h4><br>
            <table class="table table-dark table-striped">
                <thead>
                    <tr>
                        <th>rank</th>
                        <th>disease</th>
                        <th>count</th>
                    </tr>
                </thead>
                <tbody>
                    {% for i in d %}
                    <tr>
                        <td>{{ i.rank }}</td>
                        <td>{{ i.disease }}</td>
                        <td>{{ i.count }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}

        {% if c %}
        <div class="chart_container">
            <h4 class="text-center"><u>다빈도상병(입원)</u></h4><br>
            <table class="table table-dark table-striped">
                <thead>
                    <tr>
                        <th>rank</th>
                        <th>disease</th>
                        <th>count</th>
                    </tr>
                </thead>
                <tbody>
                    {% for i in c %}
                    <tr>
                        <td>{{ i.rank }}</td>
                        <td>{{ i.disease }}</td>
                        <td>{{ i.count }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}
    </div>
{% endif %}
{% endblock %}
